{% extends 'backtester/base.html' %}
{% load static %}

{% block content %}
  <main>
    <section id="symbol-info"></section>
    <section id="advanced-chart"></section>
    <section id="company-profile"></section>
    <section id="fundamental-data"></section>
    <section id="technical-analysis"></section>
    <section id="top-stories"></section>
  </main>
  <template id="symbol-info-template">
    <!-- TradingView Widget BEGIN -->
    <div class="tradingview-widget-container">
      <div class="tradingview-widget-container__widget"></div>
      <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-symbol-info.js" async>
      {
      "symbol": "NASDAQ:AAPL",
      "width": "100%",
      "locale": "en",
      "colorTheme": "light",
      "isTransparent": true
       }
    </script>
    </div>
    <!-- TradingView Widget END -->
  </template>
  <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
  <template id="advanced-chart-template">
    <!-- TradingView Widget BEGIN -->
    <div class="tradingview-widget-container" style="height: 100%; width: 100%">
      <div id="tradingview_ae7da" style="height: calc(100% - 32px); width: 100%"></div>

      <script type="text/javascript">
      new TradingView.widget({
        autosize: true,
        symbol: '{{ symbol }}',
        interval: 'D',
        timezone: 'Etc/UTC',
        theme: 'light',
        style: '1',
        locale: 'en',
        enable_publishing: false,
        hide_side_toolbar: true,
        {% comment %} studies: ['STD;MACD'], {% endcomment %}
        container_id: 'tradingview_ae7da',
      });
    </script>
    </div>
    <!-- TradingView Widget END -->
  </template>
  <template id="company-profile-template">
    <!-- TradingView Widget BEGIN -->
    <div class="tradingview-widget-container">
      <div class="tradingview-widget-container__widget"></div>
      <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-symbol-profile.js" async>
        {
        "width": "100%",
        "height": "100%",
        "colorTheme": "light",
        "isTransparent": true,
        "symbol": "NASDAQ:AAPL",
        "locale": "en"
      }
    </script>
    </div>
    <!-- TradingView Widget END -->
  </template>
  <template id="fundamental-data-template">
    <!-- TradingView Widget BEGIN -->
    <div class="tradingview-widget-container">
      <div class="tradingview-widget-container__widget"></div>
      <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-financials.js" async>
        {
        "colorTheme": "light",
        "isTransparent": true,
        "largeChartUrl": "",
        "displayMode": "adaptive",
        "width": "100%",
        "height": "100%",
        "symbol": "NASDAQ:AAPL",
        "locale": "en"
      }
    </script>
    </div>
    <!-- TradingView Widget END -->
  </template>
  <template id="technical-analysis-template">
    <!-- TradingView Widget BEGIN -->
    <div class="tradingview-widget-container">
      <div class="tradingview-widget-container__widget"></div>
      <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-technical-analysis.js" async>
      {
      "interval": "15m",
      "width": "100%",
      "isTransparent": true,
      "height": "100%",
      "symbol": "NASDAQ:AAPL",
      "showIntervalTabs": true,
      "displayMode": "single",
      "locale": "en",
      "colorTheme": "light"
       }
    </script>
    </div>
    <!-- TradingView Widget END -->
  </template>
  <template id="top-stories-template">
    <!-- TradingView Widget BEGIN -->
    <div class="tradingview-widget-container">
      <div class="tradingview-widget-container__widget"></div>
      <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-timeline.js" async>
        {
        "feedMode": "symbol",
        "symbol": "NASDAQ:AAPL",
        "colorTheme": "light",
        "isTransparent": true,
        "displayMode": "regular",
        "width": "100%",
        "height": "100%",
        "locale": "en"
      }
    </script>
    </div>
    <!-- TradingView Widget END -->
  </template>
  <script>
    // Take the symbol from backend to be used in the JavaScript code to reaplce the default symbols for the TradingView widgets
    const symbol = "{{ symbol|safe }}";
  </script>
  <script type="text/javascript" src="{% static 'backtester/instrument_detail.js' %}"></script>
  <link href="{% static 'backtester/instrument_detail.css' %}" rel="stylesheet" />
{% endblock %}
